<!-- 
==================================================
ì„¸ê³„ê´€ í‘œì‹œ ì»´í¬ë„ŒíŠ¸ - ì›ë³¸ í…ìŠ¤íŠ¸ ì¤‘ì‹¬ UI
==================================================
ë³µì¡í•œ íŒŒì‹± ì—†ì´ AIê°€ ìƒì„±í•œ ì›ë³¸ í…ìŠ¤íŠ¸ë¥¼ ê¹”ë”í•˜ê²Œ ë³´ì—¬ì£¼ëŠ” ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤.

ì£¼ìš” ê¸°ëŠ¥:
1. ì›ë³¸/í¬ë§· í…ìŠ¤íŠ¸ í† ê¸€
2. ì „ë¬¸ ë³µì‚¬ ê¸°ëŠ¥  
3. ì½ê¸° í†µê³„ (ë‹¨ì–´ìˆ˜, ì˜ˆìƒ ì½ê¸° ì‹œê°„)
4. í™•ì¥/ì¶•ì†Œ ê¸°ëŠ¥
5. ê¹”ë”í•œ íƒ€ì´í¬ê·¸ë˜í”¼
-->

<div class="world-display-container" *ngIf="gameWorld">
  <!-- ==================== í—¤ë” ì„¹ì…˜ ==================== -->
  <mat-card class="world-header-card">
    <mat-card-header>
      <div mat-card-avatar class="world-avatar">ğŸŒ</div>
      <mat-card-title>{{ gameWorld.theme || 'ìƒì„±ëœ ì„¸ê³„ê´€' }}</mat-card-title>
      <mat-card-subtitle>{{ gameWorld.setting || gameWorld.originalInput || 'ìƒˆë¡œìš´ ê²Œì„ ì„¸ê³„' }}</mat-card-subtitle>
    </mat-card-header>

    <!-- ì»¨íŠ¸ë¡¤ ë²„íŠ¼ë“¤ -->
    <mat-card-actions class="world-controls">
      <!-- í†µê³„ ì •ë³´ -->
      <div class="stats-info">
        <mat-chip-set>
          <mat-chip>ğŸ“ {{ getWordCount() }}ë‹¨ì–´</mat-chip>
          <mat-chip>ğŸ“– {{ getEstimatedReadTime() }}ë¶„ ì½ê¸°</mat-chip>
          <mat-chip>ğŸ“Š {{ getCharCount() }}ì</mat-chip>
        </mat-chip-set>
      </div>

      <!-- ì•¡ì…˜ ë²„íŠ¼ë“¤ -->
      <div class="action-buttons">
        <!-- ë³µì‚¬ ë²„íŠ¼ -->
        <button 
          mat-icon-button 
          (click)="copyToClipboard()" 
          matTooltip="ì „ë¬¸ ë³µì‚¬"
          color="primary">
          <mat-icon>content_copy</mat-icon>
        </button>

        <!-- ì›ë³¸/í¬ë§· í† ê¸€ -->
        <button 
          mat-icon-button 
          (click)="toggleRawText()" 
          [matTooltip]="showRawText ? 'í¬ë§·ëœ í…ìŠ¤íŠ¸ ë³´ê¸°' : 'ì›ë³¸ í…ìŠ¤íŠ¸ ë³´ê¸°'"
          [color]="showRawText ? 'accent' : 'primary'">
          <mat-icon>{{ showRawText ? 'article' : 'code' }}</mat-icon>
        </button>

        <!-- í™•ì¥/ì¶•ì†Œ í† ê¸€ -->
        <button 
          mat-icon-button 
          (click)="toggleExpanded()" 
          [matTooltip]="isExpanded ? 'ì¶•ì†Œí•˜ê¸°' : 'ì „ì²´ ë³´ê¸°'"
          color="primary">
          <mat-icon>{{ isExpanded ? 'expand_less' : 'expand_more' }}</mat-icon>
        </button>
      </div>
    </mat-card-actions>
  </mat-card>

  <!-- ==================== í…ìŠ¤íŠ¸ í‘œì‹œ ì˜ì—­ ==================== -->
  <mat-card class="world-content-card">
    <!-- ëª¨ë“œ í‘œì‹œ -->
    <div class="display-mode-indicator" *ngIf="!isExpanded || showRawText">
      <mat-chip 
        [color]="showRawText ? 'accent' : 'primary'" 
        selected>
        {{ showRawText ? 'ì›ë³¸ í…ìŠ¤íŠ¸' : 'í¬ë§·ëœ í…ìŠ¤íŠ¸' }}
        {{ !isExpanded ? ' (ë¯¸ë¦¬ë³´ê¸°)' : '' }}
      </mat-chip>
    </div>

    <!-- ë©”ì¸ í…ìŠ¤íŠ¸ ë‚´ìš© -->
    <mat-card-content class="world-text-content">
      <div 
        class="text-display"
        [class.raw-text-mode]="showRawText"
        [class.formatted-text-mode]="!showRawText"
        [class.preview-mode]="!isExpanded"
        [innerHTML]="getFormattedDescription()">
      </div>

      <!-- ë¯¸ë¦¬ë³´ê¸° ëª¨ë“œì—ì„œ ë”ë³´ê¸° ì•ˆë‚´ -->
      <div class="preview-notice" *ngIf="!isExpanded && gameWorld.expandedWorldDescription && gameWorld.expandedWorldDescription.length > 300">
        <button 
          mat-stroked-button 
          color="primary" 
          (click)="toggleExpanded()">
          <mat-icon>expand_more</mat-icon>
          ì „ì²´ ë‚´ìš© ë³´ê¸° ({{ getExpandedWordCount() }}ë‹¨ì–´ ë”)
        </button>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- ==================== ìƒì„± ì •ë³´ ==================== -->
  <mat-card class="world-meta-card" *ngIf="gameWorld.createdAt">
    <mat-card-content>
      <div class="meta-info">
        <div class="meta-item">
          <mat-icon>schedule</mat-icon>
          <span>{{ gameWorld.createdAt | date:'medium' }}ì— ìƒì„±ë¨</span>
        </div>
        <div class="meta-item" *ngIf="gameWorld.originalInput">
          <mat-icon>lightbulb</mat-icon>
          <span>ì›ë³¸ í”„ë¡¬í”„íŠ¸: "{{ gameWorld.originalInput }}"</span>
        </div>
      </div>
    </mat-card-content>
  </mat-card>
</div>

<!-- ì„¸ê³„ê´€ì´ ì—†ì„ ë•Œ í‘œì‹œ -->
<div class="no-world-placeholder" *ngIf="!gameWorld">
  <mat-card class="placeholder-card">
    <mat-card-content>
      <div class="placeholder-content">
        <mat-icon class="placeholder-icon">public</mat-icon>
        <h3>ì„¸ê³„ê´€ì„ ìƒì„±í•´ì£¼ì„¸ìš”</h3>
        <p>ìœ„ì˜ ì…ë ¥ í¼ì„ ì‚¬ìš©í•´ì„œ ìƒˆë¡œìš´ ê²Œì„ ì„¸ê³„ê´€ì„ ë§Œë“¤ì–´ë³´ì„¸ìš”!</p>
      </div>
    </mat-card-content>
  </mat-card>
</div>
